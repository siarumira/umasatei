<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ã‚¦ãƒå¨˜ è©•ä¾¡ç‚¹ è¨ˆç®—ãƒ„ãƒ¼ãƒ«</title>
    <style>
        /* ------------------------------------------------ */
        /* CSS (ã‚¹ã‚¿ã‚¤ãƒ«) éƒ¨åˆ† */
        /* ------------------------------------------------ */
        body { 
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; 
            max-width: 650px; 
            margin: 0 auto; 
            padding: 20px; 
            background-color: #f4f4f9; 
        }
        h1 { 
            color: #5a2e6f; 
            text-align: center; 
            border-bottom: 2px solid #5a2e6f;
            padding-bottom: 10px;
        }
        h2 {
            color: #3b1f4c;
            font-size: 1.3em;
            margin-top: 0;
        }
        .section { 
            margin-bottom: 25px; 
            padding: 15px; 
            border: 1px solid #ccc; 
            border-radius: 8px; 
            background-color: white; 
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
        .input-group, .result-item { 
            display: flex; 
            justify-content: space-between; 
            align-items: center; 
            margin-bottom: 10px; 
        }
        .input-group label { 
            flex: 1.5; 
            font-weight: bold; 
            color: #333;
        }
        /* Date input needs more width than a number field but less than full text */
        .input-group input[type="date"] {
            flex: 2; 
            padding: 8px; 
            border: 1px solid #ddd; 
            border-radius: 4px; 
            text-align: right;
        }
        .input-group input[type="number"], .input-group input[type="text"] { 
            flex: 2; 
            padding: 8px; 
            border: 1px solid #ddd; 
            border-radius: 4px; 
            text-align: right;
        }
        .input-group input[type="text"] {
            text-align: left;
        }
        .input-group input[type="checkbox"] { 
            width: 20px; 
            height: 20px;
            cursor: pointer; 
        }
        .result-item { 
            font-size: 1.1em; 
            padding: 5px 0; 
        }
        .result-item span { 
            font-weight: bold; 
            color: #d63384; 
            font-size: 1.2em;
        }
        .result-item.highlight span {
            color: #5a2e6f;
            font-size: 1.3em;
        }
        hr {
            border: 0;
            height: 1px;
            background-color: #eee;
            margin: 15px 0;
        }
        .note { 
            font-size: 0.9em; 
            color: #666; 
            margin-top: 15px; 
            border-left: 3px solid #5a2e6f; 
            padding-left: 10px; 
            background-color: #f9f9f9;
            padding: 10px;
            border-radius: 4px;
        }
        button {
            width: 100%;
            padding: 10px;
            background-color: #5a2e6f;
            color: white;
            border: none;
            border-radius: 5px;
            font-size: 1em;
            cursor: pointer;
            transition: background-color 0.3s;
            margin-top: 5px; /* ãƒœã‚¿ãƒ³é–“ã®é–“éš”èª¿æ•´ */
        }
        button:hover {
            background-color: #3b1f4c;
        }
        button.delete {
            background-color: #dc3545;
        }
        button.delete:hover {
            background-color: #c82333;
        }
        /* å±¥æ­´ãƒ†ãƒ¼ãƒ–ãƒ«ã®ã‚¹ã‚¿ã‚¤ãƒ« */
        .history-table { width: 100%; border-collapse: collapse; margin-top: 10px; font-size: 0.85em; }
        .history-table th, .history-table td { border: 1px solid #ddd; padding: 6px; text-align: center; }
        .history-table th { background-color: #f0f0f5; color: #3b1f4c; cursor: pointer; user-select: none; }
        .history-table th.sortable:hover { background-color: #e0e0e5; }
        .history-table th .sort-indicator { margin-left: 5px; font-size: 0.8em; }
        .history-table td:nth-child(2) { text-align: left; } /* ã‚­ãƒ£ãƒ©å */
        .history-table td:nth-child(4) { font-weight: bold; color: #5a2e6f; } /* åˆè¨ˆè©•ä¾¡ç‚¹ */
        
        /* èª­è¾¼ã€å‰Šé™¤ã®ã‚¢ã‚¤ã‚³ãƒ³ç”¨ã‚¹ã‚¿ã‚¤ãƒ« */
        .history-table td.load-btn { cursor: pointer; color: #007bff; width: 30px; padding: 3px 6px; font-size: 1.1em; }
        .history-table td.delete-btn { cursor: pointer; color: #dc3545; width: 30px; padding: 3px 6px; font-size: 1.1em; }
        
        /* å±¥æ­´å…¨ä½“å…±æœ‰ãƒœã‚¿ãƒ³ã®ã‚¹ã‚¿ã‚¤ãƒ« */
        #export_history_btn {
            background-color: #008000;
            margin-bottom: 5px;
        }
        #export_history_btn:hover {
            background-color: #006400;
        }

        /* ã‚¹ãƒãƒ›å¯¾å¿œã®ãŸã‚ã®èª¿æ•´ */
        @media (max-width: 650px) {
            body { padding: 10px; }
            .input-group { flex-direction: column; align-items: flex-start; }
            .input-group label { width: 100%; margin-bottom: 5px; }
            .input-group input[type="number"], .input-group input[type="text"], .input-group input[type="date"] { width: 100%; }
        }
    </style>
</head>
<body>
    <h1>ğŸ´ ã‚¦ãƒå¨˜ è©•ä¾¡ç‚¹ è¨ˆç®—ãƒ„ãƒ¼ãƒ«</h1>

    <div class="section">
        <h2>ğŸ“Š ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹å…¥åŠ›</h2>
        <div class="input-group"><label for="speed">ã‚¹ãƒ”ãƒ¼ãƒ‰ (Max 2000)</label><input type="number" id="speed" min="0" max="2000" oninput="calculate()"></div>
        <div class="input-group"><label for="stamina">ã‚¹ã‚¿ãƒŸãƒŠ (Max 2000)</label><input type="number" id="stamina" min="0" max="2000" oninput="calculate()"></div>
        <div class="input-group"><label for="power">ãƒ‘ãƒ¯ãƒ¼ (Max 2000)</label><input type="number" id="power" min="0" max="2000" oninput="calculate()"></div>
        <div class="input-group"><label for="guts">æ ¹æ€§ (Max 2000)</label><input type="number" id="guts" min="0" max="2000" oninput="calculate()"></div>
        <div class="input-group"><label for="wisdom">è³¢ã• (Max 2000)</label><input type="number" id="wisdom" min="0" max="2000" oninput="calculate()"></div>
        <div class="input-group"><label for="unique_level">å›ºæœ‰ãƒ¬ãƒ™ãƒ« (Max 6)</label><input type="number" id="unique_level" min="0" max="6" oninput="calculate()"></div>
    </div>

    <div class="section">
        <h2>ğŸ› ï¸ è¨ˆç®—æ¡ä»¶å…¥åŠ›</h2>
        <div class="input-group"><label for="char_name">ã‚­ãƒ£ãƒ©å (ä¿å­˜ç”¨)</label><input type="text" id="char_name" oninput="saveData()"></div>
        <div class="input-group"><label for="calc_date">æ—¥ä»˜</label><input type="date" id="calc_date" oninput="calculate()"></div> 

        <div class="input-group"><label for="target_rating">è©•ä¾¡ç‚¹</label><input type="number" id="target_rating" min="0" oninput="calculate()"></div>
        <div class="input-group"><label for="sp">SP (ã‚¹ã‚­ãƒ«ãƒã‚¤ãƒ³ãƒˆ)</label><input type="number" id="sp" min="0" oninput="calculate()"></div>
        <div class="input-group">
            <label for="kirereality">åˆ‡ã‚Œè€…</label>
            <input type="checkbox" id="kirereality" onchange="calculate()">
        </div>
        <div class="input-group">
            <label for="hari">é‡</label>
            <input type="checkbox" id="hari" onchange="calculate()">
        </div>
    </div>

    <div class="section">
        <h2>âœ¨ è¨ˆç®—çµæœ</h2>
        <div class="result-item">ç·åˆã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ç‚¹: <span id="status_points">0</span></div>
        <div class="result-item">å›ºæœ‰è©•ä¾¡ç‚¹: <span id="unique_points">0</span></div>
        <div class="result-item">ã‚¹ã‚­ãƒ«ç‚¹ (é€†ç®—å€¤): <span id="skill_points">0</span></div>
        <div class="result-item">åŠ¹ç‡ (ã‚¹ã‚­ãƒ«ç‚¹ / SP): <span id="efficiency">0.00</span></div>
        <hr>
        <div class="result-item highlight">åˆè¨ˆè©•ä¾¡ç‚¹: <span id="total_rating">0</span></div>
    </div>

    <div class="section">
        <h2>ğŸ—‘ï¸ Webå†…å±¥æ­´ä¿å­˜</h2>
        <button onclick="saveCurrentCalculationToWeb()">è¨ˆç®—çµæœã‚’å±¥æ­´ã«ä¿å­˜</button>
        <button onclick="deleteAllHistory()" class="delete">å±¥æ­´ã‚’å…¨ã¦å‰Šé™¤</button>
        <div class="note">
            å±¥æ­´ãƒ‡ãƒ¼ã‚¿ã¯ãƒ–ãƒ©ã‚¦ã‚¶å†…ã«è‡ªå‹•çš„ã«ä¿å­˜ã•ã‚Œã¾ã™ã€‚ï¼ˆæœ€å¤§50ä»¶ï¼‰<br>
            â€»ä¿å­˜å¾Œã€**ã‚­ãƒ£ãƒ©åä»¥å¤–ã®**å…¥åŠ›å†…å®¹ã¨è¨ˆç®—çµæœã¯è‡ªå‹•ã§ã‚¯ãƒªã‚¢ã•ã‚Œã¾ã™ã€‚
        </div>
    </div>
    
    <div class="section">
        <h2>ğŸ’¾ ãƒ‡ãƒ¼ã‚¿ç§»è¡Œ (åˆ¥ç«¯æœ«ã¨ã®å…±æœ‰ãƒ»åŒæœŸ)</h2>
        <button id="export_history_btn" onclick="generateShareIdForAllHistory()">ğŸ“¤ å…¨å±¥æ­´ã‚’ãƒ‡ãƒ¼ã‚¿ç§»è¡Œç”¨IDã¨ã—ã¦æ›¸ãå‡ºã™ãƒ»ã‚³ãƒ”ãƒ¼</button>
        
        <div style="margin-top: 15px;">
            <label for="migration_id_input" style="font-weight: normal; margin-bottom: 5px; display: block; text-align: left;">ç§»è¡Œç”¨IDã‚’è²¼ã‚Šä»˜ã‘ã¦èª­ã¿è¾¼ã‚€:</label>
            <div style="display: flex; gap: 5px;">
                <input type="text" id="migration_id_input" placeholder="é•·ã„Base64 IDã¾ãŸã¯URLå…¨ä½“ã‚’è²¼ã‚Šä»˜ã‘" style="flex: 3; text-align: left;">
                <button onclick="loadManualMigrationId()" style="flex: 1; min-width: 80px; padding: 5px; margin: 0;">èª­è¾¼</button>
            </div>
        </div>
        
        <div class="note" style="border-left: 3px solid #008000;">
            ã“ã®æ©Ÿèƒ½ã¯ã€**ç«¯æœ«A â†’ ç«¯æœ«B**ã¸ã®å±¥æ­´ãƒ‡ãƒ¼ã‚¿ç§»è¡Œã«ã”åˆ©ç”¨ãã ã•ã„ã€‚èª­ã¿è¾¼ã‚“ã ãƒ‡ãƒ¼ã‚¿ã¯ã€ç¾åœ¨ã®**ãƒ–ãƒ©ã‚¦ã‚¶ã®å±¥æ­´**ã«ä¸Šæ›¸ãä¿å­˜ã•ã‚Œã¾ã™ã€‚
        </div>
    </div>

    
    <div class="section" id="history_section" style="display:none;">
        <h2>ğŸ“ è©•ä¾¡ç‚¹ å±¥æ­´</h2>
        <div id="history_table_container">
            </div>
    </div>

    <script>
        // ----------------------------------------------------
        // 1. ãƒ‡ãƒ¼ã‚¿ãƒ†ãƒ¼ãƒ–ãƒ«ã®å®šç¾©ã¨å®šæ•°
        // ----------------------------------------------------

        // â˜…â˜…â˜… CSVãƒ‡ãƒ¼ã‚¿ã‚’ã“ã“ã«è²¼ã‚Šä»˜ã‘ã¦ãã ã•ã„ â˜…â˜…â˜…
        const csvDataString = `
ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹,è©•ä¾¡ç‚¹,ä¸Šæ˜‡é‡,,å›ºæœ‰,
0,0,0,,0,0
1,1,1,,1,170
2,1,0,,2,340
3,2,1,,3,510
4,2,0,,4,680
5,3,1,,5,850
6,3,0,,6,1020
7,4,1,,,
8,4,0,,,
9,5,1,,,
10,5,0,,,
11,6,1,,,
12,6,0,,,
13,7,1,,,
14,7,0,,,
15,8,1,,,
16,8,0,,,
17,9,1,,,
18,9,0,,,
19,10,1,,,
20,10,0,,,
21,11,1,,,
22,11,0,,,
23,12,1,,,
24,12,0,,,
25,13,1,,,
26,13,0,,,
27,14,1,,,
28,14,0,,,
29,15,1,,,
30,15,0,,,
31,16,1,,,
32,16,0,,,
33,17,1,,,
34,17,0,,,
35,18,1,,,
36,18,0,,,
37,19,1,,,
38,19,0,,,
39,20,1,,,
40,20,0,,,
41,21,1,,,
42,21,0,,,
43,22,1,,,
44,22,0,,,
45,23,1,,,
46,23,0,,,
47,24,1,,,
48,24,0,,,
49,25,1,,,
50,25,0,,,
51,26,1,,,
52,27,1,,,
53,28,1,,,
54,29,1,,,
55,29,0,,,
56,30,1,,,
57,31,1,,,
58,32,1,,,
59,33,1,,,
60,33,0,,,
61,34,1,,,
62,35,1,,,
63,36,1,,,
64,37,1,,,
65,37,0,,,
66,38,1,,,
67,39,1,,,
68,40,1,,,
69,41,1,,,
70,41,0,,,
71,42,1,,,
72,43,1,,,
73,44,1,,,
74,45,1,,,
75,45,0,,,
76,46,1,,,
77,47,1,,,
78,48,1,,,
79,49,1,,,
80,49,0,,,
81,50,1,,,
82,51,1,,,
83,52,1,,,
84,53,1,,,
85,53,0,,,
86,54,1,,,
87,55,1,,,
88,56,1,,,
89,57,1,,,
90,57,0,,,
91,58,1,,,
92,59,1,,,
93,60,1,,,
94,61,1,,,
95,61,0,,,
96,62,1,,,
97,63,1,,,
98,64,1,,,
99,65,1,,,
100,66,1,,,
101,67,1,,,
102,68,1,,,
103,69,1,,,
104,70,1,,,
105,71,1,,,
106,72,1,,,
107,73,1,,,
108,74,1,,,
109,75,1,,,
110,76,1,,,
111,77,1,,,
112,78,1,,,
113,79,1,,,
114,80,1,,,
115,81,1,,,
116,82,1,,,
117,83,1,,,
118,84,1,,,
119,85,1,,,
120,86,1,,,
121,87,1,,,
122,88,1,,,
123,89,1,,,
124,90,1,,,
125,91,1,,,
126,92,1,,,
127,93,1,,,
128,94,1,,,
129,95,1,,,
130,96,1,,,
131,97,1,,,
132,98,1,,,
133,99,1,,,
134,100,1,,,
135,101,1,,,
136,102,1,,,
137,103,1,,,
138,104,1,,,
139,105,1,,,
140,106,1,,,
141,107,1,,,
142,108,1,,,
143,109,1,,,
144,110,1,,,
145,111,1,,,
146,112,1,,,
147,113,1,,,
148,114,1,,,
149,115,1,,,
150,116,1,,,
151,117,1,,,
152,118,1,,,
153,120,2,,,
154,121,1,,,
155,122,1,,,
156,124,2,,,
157,125,1,,,
158,126,1,,,
159,128,2,,,
160,129,1,,,
161,130,1,,,
162,131,1,,,
163,133,2,,,
164,134,1,,,
165,135,1,,,
166,137,2,,,
167,138,1,,,
168,139,1,,,
169,141,2,,,
170,142,1,,,
171,143,1,,,
172,144,1,,,
173,146,2,,,
174,147,1,,,
175,148,1,,,
176,150,2,,,
177,151,1,,,
178,152,1,,,
179,154,2,,,
180,155,1,,,
181,156,1,,,
182,157,1,,,
183,159,2,,,
184,160,1,,,
185,161,1,,,
186,163,2,,,
187,164,1,,,
188,165,1,,,
189,167,2,,,
190,168,1,,,
191,169,1,,,
192,170,1,,,
193,172,2,,,
194,173,1,,,
195,174,1,,,
196,176,2,,,
197,177,1,,,
198,178,1,,,
199,180,2,,,
200,181,1,,,
201,183,2,,,
202,184,1,,,
203,186,2,,,
204,188,2,,,
205,189,1,,,
206,191,2,,,
207,192,1,,,
208,194,2,,,
209,196,2,,,
210,197,1,,,
211,199,2,,,
212,200,1,,,
213,202,2,,,
214,204,2,,,
215,205,1,,,
216,207,2,,,
217,208,1,,,
218,210,2,,,
219,212,2,,,
220,213,1,,,
221,215,2,,,
222,216,1,,,
223,218,2,,,
224,220,2,,,
225,221,1,,,
226,223,2,,,
227,224,1,,,
228,226,2,,,
229,228,2,,,
230,229,1,,,
231,231,2,,,
232,232,1,,,
233,234,2,,,
234,236,2,,,
235,237,1,,,
236,239,2,,,
237,240,1,,,
238,242,2,,,
239,244,2,,,
240,245,1,,,
241,247,2,,,
242,248,1,,,
243,250,2,,,
244,252,2,,,
245,253,1,,,
246,255,2,,,
247,256,1,,,
248,258,2,,,
249,260,2,,,
250,261,1,,,
251,263,2,,,
252,265,2,,,
253,267,2,,,
254,269,2,,,
255,270,1,,,
256,272,2,,,
257,274,2,,,
258,276,2,,,
259,278,2,,,
260,279,1,,,
261,281,2,,,
262,283,2,,,
263,285,2,,,
264,287,2,,,
265,288,1,,,
266,290,2,,,
267,292,2,,,
268,294,2,,,
269,296,2,,,
270,297,1,,,
271,299,2,,,
272,301,2,,,
273,303,2,,,
274,305,2,,,
275,306,1,,,
276,308,2,,,
277,310,2,,,
278,312,2,,,
279,314,2,,,
280,315,1,,,
281,317,2,,,
282,319,2,,,
283,321,2,,,
284,323,2,,,
285,324,1,,,
286,326,2,,,
287,328,2,,,
288,330,2,,,
289,332,2,,,
290,333,1,,,
291,335,2,,,
292,337,2,,,
293,339,2,,,
294,341,2,,,
295,342,1,,,
296,344,2,,,
297,346,2,,,
298,348,2,,,
299,350,2,,,
300,352,2,,,
301,354,2,,,
302,356,2,,,
303,358,2,,,
304,360,2,,,
305,362,2,,,
306,364,2,,,
307,366,2,,,
308,368,2,,,
309,371,3,,,
310,373,2,,,
311,375,2,,,
312,377,2,,,
313,379,2,,,
314,381,2,,,
315,383,2,,,
316,385,2,,,
317,387,2,,,
318,389,2,,,
319,392,3,,,
320,394,2,,,
321,396,2,,,
322,398,2,,,
323,400,2,,,
324,402,2,,,
325,404,2,,,
326,406,2,,,
327,408,2,,,
328,410,2,,,
329,413,3,,,
330,415,2,,,
331,417,2,,,
332,419,2,,,
333,421,2,,,
334,423,2,,,
335,425,2,,,
336,427,2,,,
337,429,2,,,
338,431,2,,,
339,434,3,,,
340,436,2,,,
341,438,2,,,
342,440,2,,,
343,442,2,,,
344,444,2,,,
345,446,2,,,
346,448,2,,,
347,450,2,,,
348,452,2,,,
349,455,3,,,
350,457,2,,,
351,459,2,,,
352,462,3,,,
353,464,2,,,
354,467,3,,,
355,469,2,,,
356,471,2,,,
357,474,3,,,
358,476,2,,,
359,479,3,,,
360,481,2,,,
361,483,2,,,
362,486,3,,,
363,488,2,,,
364,491,3,,,
365,493,2,,,
366,495,2,,,
367,498,3,,,
368,500,2,,,
369,503,3,,,
370,505,2,,,
371,507,2,,,
372,510,3,,,
373,512,2,,,
374,515,3,,,
375,517,2,,,
376,519,2,,,
377,522,3,,,
378,524,2,,,
379,527,3,,,
380,529,2,,,
381,531,2,,,
382,534,3,,,
383,536,2,,,
384,539,3,,,
385,541,2,,,
386,543,2,,,
387,546,3,,,
388,548,2,,,
389,551,3,,,
390,553,2,,,
391,555,2,,,
392,558,3,,,
393,560,2,,,
394,563,3,,,
395,565,2,,,
396,567,2,,,
397,570,3,,,
398,572,2,,,
399,575,3,,,
400,577,2,,,
401,580,3,,,
402,582,2,,,
403,585,3,,,
404,588,3,,,
405,590,2,,,
406,593,3,,,
407,595,2,,,
408,598,3,,,
409,601,3,,,
410,603,2,,,
411,606,3,,,
412,608,2,,,
413,611,3,,,
414,614,3,,,
415,616,2,,,
416,619,3,,,
417,621,2,,,
418,624,3,,,
419,627,3,,,
420,629,2,,,
421,632,3,,,
422,634,2,,,
423,637,3,,,
424,640,3,,,
425,642,2,,,
426,645,3,,,
427,647,2,,,
428,650,3,,,
429,653,3,,,
430,655,2,,,
431,658,3,,,
432,660,2,,,
433,663,3,,,
434,666,3,,,
435,668,2,,,
436,671,3,,,
437,673,2,,,
438,676,3,,,
439,679,3,,,
440,681,2,,,
441,684,3,,,
442,686,2,,,
443,689,3,,,
444,692,3,,,
445,694,2,,,
446,697,3,,,
447,699,2,,,
448,702,3,,,
449,705,3,,,
450,707,2,,,
451,710,3,,,
452,713,3,,,
453,716,3,,,
454,719,3,,,
455,721,2,,,
456,724,3,,,
457,727,3,,,
458,730,3,,,
459,733,3,,,
460,735,2,,,
461,738,3,,,
462,741,3,,,
463,744,3,,,
464,747,3,,,
465,749,2,,,
466,752,3,,,
467,755,3,,,
468,758,3,,,
469,761,3,,,
470,763,2,,,
471,766,3,,,
472,769,3,,,
473,772,3,,,
474,775,3,,,
475,777,2,,,
476,780,3,,,
477,783,3,,,
478,786,3,,,
479,789,3,,,
480,791,2,,,
481,794,3,,,
482,797,3,,,
483,800,3,,,
484,803,3,,,
485,805,2,,,
486,808,3,,,
487,811,3,,,
488,814,3,,,
489,817,3,,,
490,819,2,,,
491,822,3,,,
492,825,3,,,
493,828,3,,,
494,831,3,,,
495,833,2,,,
496,836,3,,,
497,839,3,,,
498,842,3,,,
499,845,3,,,
500,847,2,,,
501,850,3,,,
502,853,3,,,
503,856,3,,,
504,859,3,,,
505,862,3,,,
506,865,3,,,
507,868,3,,,
508,871,3,,,
509,874,3,,,
510,876,2,,,
511,879,3,,,
512,882,3,,,
513,885,3,,,
514,888,3,,,
515,891,3,,,
516,894,3,,,
517,897,3,,,
518,900,3,,,
519,903,3,,,
520,905,2,,,
521,908,3,,,
522,911,3,,,
523,914,3,,,
524,917,3,,,
525,920,3,,,
526,923,3,,,
527,926,3,,,
528,929,3,,,
529,932,3,,,
530,934,2,,,
531,937,3,,,
532,940,3,,,
533,943,3,,,
534,946,3,,,
535,949,3,,,
536,952,3,,,
537,955,3,,,
538,958,3,,,
539,961,3,,,
540,963,2,,,
541,966,3,,,
542,969,3,,,
543,972,3,,,
544,975,3,,,
545,978,3,,,
546,981,3,,,
547,984,3,,,
548,987,3,,,
549,990,3,,,
550,993,3,,,
551,996,3,,,
552,999,3,,,
553,1002,3,,,
554,1005,3,,,
555,1008,3,,,
556,1011,3,,,
557,1014,3,,,
558,1017,3,,,
559,1020,3,,,
560,1023,3,,,
561,1026,3,,,
562,1029,3,,,
563,1032,3,,,
564,1035,3,,,
565,1038,3,,,
566,1041,3,,,
567,1044,3,,,
568,1047,3,,,
569,1050,3,,,
570,1053,3,,,
571,1056,3,,,
572,1059,3,,,
573,1062,3,,,
574,1065,3,,,
575,1068,3,,,
576,1071,3,,,
577,1074,3,,,
578,1077,3,,,
579,1080,3,,,
580,1083,3,,,
581,1086,3,,,
582,1089,3,,,
583,1092,3,,,
584,1095,3,,,
585,1098,3,,,
586,1101,3,,,
587,1104,3,,,
588,1107,3,,,
589,1110,3,,,
590,1113,3,,,
591,1116,3,,,
592,1119,3,,,
593,1122,3,,,
594,1125,3,,,
595,1128,3,,,
596,1131,3,,,
597,1134,3,,,
598,1137,3,,,
599,1140,3,,,
600,1143,3,,,
601,1146,3,,,
602,1149,3,,,
603,1152,3,,,
604,1155,3,,,
605,1158,3,,,
606,1161,3,,,
607,1164,3,,,
608,1167,3,,,
609,1171,4,,,
610,1174,3,,,
611,1177,3,,,
612,1180,3,,,
613,1183,3,,,
614,1186,3,,,
615,1189,3,,,
616,1192,3,,,
617,1195,3,,,
618,1198,3,,,
619,1202,4,,,
620,1205,3,,,
621,1208,3,,,
622,1211,3,,,
623,1214,3,,,
624,1217,3,,,
625,1220,3,,,
626,1223,3,,,
627,1226,3,,,
628,1229,3,,,
629,1233,4,,,
630,1236,3,,,
631,1239,3,,,
632,1242,3,,,
633,1245,3,,,
634,1248,3,,,
635,1251,3,,,
636,1254,3,,,
637,1257,3,,,
638,1260,3,,,
639,1264,4,,,
640,1267,3,,,
641,1270,3,,,
642,1273,3,,,
643,1276,3,,,
644,1279,3,,,
645,1282,3,,,
646,1285,3,,,
647,1288,3,,,
648,1291,3,,,
649,1295,4,,,
650,1298,3,,,
651,1301,3,,,
652,1304,3,,,
653,1308,4,,,
654,1311,3,,,
655,1314,3,,,
656,1318,4,,,
657,1321,3,,,
658,1324,3,,,
659,1328,4,,,
660,1331,3,,,
661,1334,3,,,
662,1337,3,,,
663,1341,4,,,
664,1344,3,,,
665,1347,3,,,
666,1351,4,,,
667,1354,3,,,
668,1357,3,,,
669,1361,4,,,
670,1364,3,,,
671,1367,3,,,
672,1370,3,,,
673,1374,4,,,
674,1377,3,,,
675,1380,3,,,
676,1384,4,,,
677,1387,3,,,
678,1390,3,,,
679,1394,4,,,
680,1397,3,,,
681,1400,3,,,
682,1403,3,,,
683,1407,4,,,
684,1410,3,,,
685,1413,3,,,
686,1417,4,,,
687,1420,3,,,
688,1423,3,,,
689,1427,4,,,
690,1430,3,,,
691,1433,3,,,
692,1436,3,,,
693,1440,4,,,
694,1443,3,,,
695,1446,3,,,
696,1450,4,,,
697,1453,3,,,
698,1456,3,,,
699,1460,4,,,
700,1463,3,,,
701,1466,3,,,
702,1470,4,,,
703,1473,3,,,
704,1477,4,,,
705,1480,3,,,
706,1483,3,,,
707,1487,4,,,
708,1490,3,,,
709,1494,4,,,
710,1497,3,,,
711,1500,3,,,
712,1504,4,,,
713,1507,3,,,
714,1511,4,,,
715,1514,3,,,
716,1517,3,,,
717,1521,4,,,
718,1524,3,,,
719,1528,4,,,
720,1531,3,,,
721,1534,3,,,
722,1538,4,,,
723,1541,3,,,
724,1545,4,,,
725,1548,3,,,
726,1551,3,,,
727,1555,4,,,
728,1558,3,,,
729,1562,4,,,
730,1565,3,,,
731,1568,3,,,
732,1572,4,,,
733,1575,3,,,
734,1579,4,,,
735,1582,3,,,
736,1585,3,,,
737,1589,4,,,
738,1592,3,,,
739,1596,4,,,
740,1599,3,,,
741,1602,3,,,
742,1606,4,,,
743,1609,3,,,
744,1613,4,,,
745,1616,3,,,
746,1619,3,,,
747,1623,4,,,
748,1626,3,,,
749,1630,4,,,
750,1633,3,,,
751,1637,4,,,
752,1640,3,,,
753,1644,4,,,
754,1647,3,,,
755,1651,4,,,
756,1654,3,,,
757,1658,4,,,
758,1661,3,,,
759,1665,4,,,
760,1668,3,,,
761,1672,4,,,
762,1675,3,,,
763,1679,4,,,
764,1682,3,,,
765,1686,4,,,
766,1689,3,,,
767,1693,4,,,
768,1696,3,,,
769,1700,4,,,
770,1703,3,,,
771,1707,4,,,
772,1710,3,,,
773,1714,4,,,
774,1717,3,,,
775,1721,4,,,
776,1724,3,,,
777,1728,4,,,
778,1731,3,,,
779,1735,4,,,
780,1738,3,,,
781,1742,4,,,
782,1745,3,,,
783,1749,4,,,
784,1752,3,,,
785,1756,4,,,
786,1759,3,,,
787,1763,4,,,
788,1766,3,,,
789,1770,4,,,
790,1773,3,,,
791,1777,4,,,
792,1780,3,,,
793,1784,4,,,
794,1787,3,,,
795,1791,4,,,
796,1794,3,,,
797,1798,4,,,
798,1801,3,,,
799,1805,4,,,
800,1808,3,,,
801,1812,4,,,
802,1816,4,,,
803,1820,4,,,
804,1824,4,,,
805,1828,4,,,
806,1832,4,,,
807,1836,4,,,
808,1840,4,,,
809,1844,4,,,
810,1847,3,,,
811,1851,4,,,
812,1855,4,,,
813,1859,4,,,
814,1863,4,,,
815,1867,4,,,
816,1871,4,,,
817,1875,4,,,
818,1879,4,,,
819,1883,4,,,
820,1886,3,,,
821,1890,4,,,
822,1894,4,,,
823,1898,4,,,
824,1902,4,,,
825,1906,4,,,
826,1910,4,,,
827,1914,4,,,
828,1918,4,,,
829,1922,4,,,
830,1925,3,,,
831,1929,4,,,
832,1933,4,,,
833,1937,4,,,
834,1941,4,,,
835,1945,4,,,
836,1949,4,,,
837,1953,4,,,
838,1957,4,,,
839,1961,4,,,
840,1964,3,,,
841,1968,4,,,
842,1972,4,,,
843,1976,4,,,
844,1980,4,,,
845,1984,4,,,
846,1988,4,,,
847,1992,4,,,
848,1996,4,,,
849,2000,4,,,
850,2004,4,,,
851,2008,4,,,
852,2012,4,,,
853,2016,4,,,
854,2020,4,,,
855,2024,4,,,
856,2028,4,,,
857,2032,4,,,
858,2036,4,,,
859,2041,5,,,
860,2045,4,,,
861,2049,4,,,
862,2053,4,,,
863,2057,4,,,
864,2061,4,,,
865,2065,4,,,
866,2069,4,,,
867,2073,4,,,
868,2077,4,,,
869,2082,5,,,
870,2086,4,,,
871,2090,4,,,
872,2094,4,,,
873,2098,4,,,
874,2102,4,,,
875,2106,4,,,
876,2110,4,,,
877,2114,4,,,
878,2118,4,,,
879,2123,5,,,
880,2127,4,,,
881,2131,4,,,
882,2135,4,,,
883,2139,4,,,
884,2143,4,,,
885,2147,4,,,
886,2151,4,,,
887,2155,4,,,
888,2159,4,,,
889,2164,5,,,
890,2168,4,,,
891,2172,4,,,
892,2176,4,,,
893,2180,4,,,
894,2184,4,,,
895,2188,4,,,
896,2192,4,,,
897,2196,4,,,
898,2200,4,,,
899,2205,5,,,
900,2209,4,,,
901,2213,4,,,
902,2217,4,,,
903,2221,4,,,
904,2226,5,,,
905,2230,4,,,
906,2234,4,,,
907,2238,4,,,
908,2242,4,,,
909,2247,5,,,
910,2251,4,,,
911,2255,4,,,
912,2259,4,,,
913,2263,4,,,
914,2268,5,,,
915,2272,4,,,
916,2276,4,,,
917,2280,4,,,
918,2284,4,,,
919,2289,5,,,
920,2293,4,,,
921,2297,4,,,
922,2301,4,,,
923,2305,4,,,
924,2310,5,,,
925,2314,4,,,
926,2318,4,,,
927,2322,4,,,
928,2326,4,,,
929,2331,5,,,
930,2335,4,,,
931,2339,4,,,
932,2343,4,,,
933,2347,4,,,
934,2352,5,,,
935,2356,4,,,
936,2360,4,,,
937,2364,4,,,
938,2368,4,,,
939,2373,5,,,
940,2377,4,,,
941,2381,4,,,
942,2385,4,,,
943,2389,4,,,
944,2394,5,,,
945,2398,4,,,
946,2402,4,,,
947,2406,4,,,
948,2410,4,,,
949,2415,5,,,
950,2419,4,,,
951,2423,4,,,
952,2427,4,,,
953,2432,5,,,
954,2436,4,,,
955,2440,4,,,
956,2445,5,,,
957,2449,4,,,
958,2453,4,,,
959,2458,5,,,
960,2462,4,,,
961,2466,4,,,
962,2470,4,,,
963,2475,5,,,
964,2479,4,,,
965,2483,4,,,
966,2488,5,,,
967,2492,4,,,
968,2496,4,,,
969,2501,5,,,
970,2505,4,,,
971,2509,4,,,
972,2513,4,,,
973,2518,5,,,
974,2522,4,,,
975,2526,4,,,
976,2531,5,,,
977,2535,4,,,
978,2539,4,,,
979,2544,5,,,
980,2548,4,,,
981,2552,4,,,
982,2556,4,,,
983,2561,5,,,
984,2565,4,,,
985,2569,4,,,
986,2574,5,,,
987,2578,4,,,
988,2582,4,,,
989,2587,5,,,
990,2591,4,,,
991,2595,4,,,
992,2599,4,,,
993,2604,5,,,
994,2608,4,,,
995,2612,4,,,
996,2617,5,,,
997,2621,4,,,
998,2625,4,,,
999,2630,5,,,
1000,2635,5,,,
1001,2640,5,,,
1002,2645,5,,,
1003,2650,5,,,
1004,2656,6,,,
1005,2661,5,,,
1006,2666,5,,,
1007,2671,5,,,
1008,2676,5,,,
1009,2682,6,,,
1010,2687,5,,,
1011,2692,5,,,
1012,2697,5,,,
1013,2702,5,,,
1014,2708,6,,,
1015,2713,5,,,
1016,2718,5,,,
1017,2723,5,,,
1018,2728,5,,,
1019,2734,6,,,
1020,2739,5,,,
1021,2744,5,,,
1022,2749,5,,,
1023,2754,5,,,
1024,2760,6,,,
1025,2765,5,,,
1026,2770,5,,,
1027,2775,5,,,
1028,2780,5,,,
1029,2786,6,,,
1030,2791,5,,,
1031,2796,5,,,
1032,2801,5,,,
1033,2806,5,,,
1034,2812,6,,,
1035,2817,5,,,
1036,2822,5,,,
1037,2827,5,,,
1038,2832,5,,,
1039,2838,6,,,
1040,2843,5,,,
1041,2848,5,,,
1042,2853,5,,,
1043,2858,5,,,
1044,2864,6,,,
1045,2869,5,,,
1046,2874,5,,,
1047,2879,5,,,
1048,2884,5,,,
1049,2890,6,,,
1050,2895,5,,,
1051,2901,6,,,
1052,2906,5,,,
1053,2912,6,,,
1054,2917,5,,,
1055,2923,6,,,
1056,2928,5,,,
1057,2934,6,,,
1058,2939,5,,,
1059,2945,6,,,
1060,2950,5,,,
1061,2956,6,,,
1062,2961,5,,,
1063,2967,6,,,
1064,2972,5,,,
1065,2978,6,,,
1066,2983,5,,,
1067,2989,6,,,
1068,2994,5,,,
1069,3000,6,,,
1070,3005,5,,,
1071,3011,6,,,
1072,3016,5,,,
1073,3022,6,,,
1074,3027,5,,,
1075,3033,6,,,
1076,3038,5,,,
1077,3044,6,,,
1078,3049,5,,,
1079,3055,6,,,
1080,3060,5,,,
1081,3066,6,,,
1082,3071,5,,,
1083,3077,6,,,
1084,3082,5,,,
1085,3088,6,,,
1086,3093,5,,,
1087,3099,6,,,
1088,3104,5,,,
1089,3110,6,,,
1090,3115,5,,,
1091,3121,6,,,
1092,3126,5,,,
1093,3132,6,,,
1094,3137,5,,,
1095,3143,6,,,
1096,3148,5,,,
1097,3154,6,,,
1098,3159,5,,,
1099,3165,6,,,
1100,3171,6,,,
1101,3178,7,,,
1102,3184,6,,,
1103,3191,7,,,
1104,3198,7,,,
1105,3204,6,,,
1106,3211,7,,,
1107,3217,6,,,
1108,3224,7,,,
1109,3231,7,,,
1110,3237,6,,,
1111,3244,7,,,
1112,3250,6,,,
1113,3257,7,,,
1114,3264,7,,,
1115,3270,6,,,
1116,3277,7,,,
1117,3283,6,,,
1118,3290,7,,,
1119,3297,7,,,
1120,3303,6,,,
1121,3310,7,,,
1122,3316,6,,,
1123,3323,7,,,
1124,3330,7,,,
1125,3336,6,,,
1126,3343,7,,,
1127,3349,6,,,
1128,3356,7,,,
1129,3363,7,,,
1130,3369,6,,,
1131,3376,7,,,
1132,3382,6,,,
1133,3389,7,,,
1134,3396,7,,,
1135,3402,6,,,
1136,3409,7,,,
1137,3415,6,,,
1138,3422,7,,,
1139,3429,7,,,
1140,3435,6,,,
1141,3442,7,,,
1142,3448,6,,,
1143,3455,7,,,
1144,3462,7,,,
1145,3468,6,,,
1146,3475,7,,,
1147,3481,6,,,
1148,3488,7,,,
1149,3495,7,,,
1150,3501,6,,,
1151,3508,7,,,
1152,3515,7,,,
1153,3522,7,,,
1154,3529,7,,,
1155,3535,6,,,
1156,3542,7,,,
1157,3549,7,,,
1158,3556,7,,,
1159,3563,7,,,
1160,3569,6,,,
1161,3576,7,,,
1162,3583,7,,,
1163,3590,7,,,
1164,3597,7,,,
1165,3603,6,,,
1166,3610,7,,,
1167,3617,7,,,
1168,3624,7,,,
1169,3631,7,,,
1170,3637,6,,,
1171,3644,7,,,
1172,3651,7,,,
1173,3658,7,,,
1174,3665,7,,,
1175,3671,6,,,
1176,3678,7,,,
1177,3685,7,,,
1178,3692,7,,,
1179,3699,7,,,
1180,3705,6,,,
1181,3712,7,,,
1182,3719,7,,,
1183,3726,7,,,
1184,3733,7,,,
1185,3739,6,,,
1186,3746,7,,,
1187,3753,7,,,
1188,3760,7,,,
1189,3767,7,,,
1190,3773,6,,,
1191,3780,7,,,
1192,3787,7,,,
1193,3794,7,,,
1194,3801,7,,,
1195,3807,6,,,
1196,3814,7,,,
1197,3821,7,,,
1198,3828,7,,,
1199,3835,7,,,
1200,3841,6,,,
1201,3849,8,,,
1202,3857,8,,,
1203,3865,8,,,
1204,3873,8,,,
1205,3881,8,,,
1206,3889,8,,,
1207,3897,8,,,
1208,3905,8,,,
1209,3912,7,,,
1210,3920,8,,,
1211,3928,8,,,
1212,3936,8,,,
1213,3944,8,,,
1214,3952,8,,,
1215,3960,8,,,
1216,3968,8,,,
1217,3976,8,,,
1218,3984,8,,,
1219,3992,8,,,
1220,4001,9,,,
1221,4009,8,,,
1222,4017,8,,,
1223,4025,8,,,
1224,4033,8,,,
1225,4041,8,,,
1226,4049,8,,,
1227,4057,8,,,
1228,4065,8,,,
1229,4073,8,,,
1230,4082,9,,,
1231,4090,8,,,
1232,4098,8,,,
1233,4107,9,,,
1234,4115,8,,,
1235,4123,8,,,
1236,4132,9,,,
1237,4140,8,,,
1238,4148,8,,,
1239,4156,8,,,
1240,4165,9,,,
1241,4173,8,,,
1242,4182,9,,,
1243,4190,8,,,
1244,4198,8,,,
1245,4207,9,,,
1246,4215,8,,,
1247,4224,9,,,
1248,4232,8,,,
1249,4240,8,,,
1250,4249,9,,,
1251,4257,8,,,
1252,4266,9,,,
1253,4274,8,,,
1254,4283,9,,,
1255,4291,8,,,
1256,4300,9,,,
1257,4308,8,,,
1258,4317,9,,,
1259,4325,8,,,
1260,4334,9,,,
1261,4343,9,,,
1262,4351,8,,,
1263,4360,9,,,
1264,4368,8,,,
1265,4377,9,,,
1266,4386,9,,,
1267,4394,8,,,
1268,4403,9,,,
1269,4411,8,,,
1270,4420,9,,,
1271,4429,9,,,
1272,4438,9,,,
1273,4447,9,,,
1274,4455,8,,,
1275,4464,9,,,
1276,4473,9,,,
1277,4482,9,,,
1278,4491,9,,,
1279,4499,8,,,
1280,4508,9,,,
1281,4517,9,,,
1282,4526,9,,,
1283,4535,9,,,
1284,4544,9,,,
1285,4553,9,,,
1286,4562,9,,,
1287,4571,9,,,
1288,4580,9,,,
1289,4588,8,,,
1290,4597,9,,,
1291,4606,9,,,
1292,4615,9,,,
1293,4624,9,,,
1294,4633,9,,,
1295,4642,9,,,
1296,4651,9,,,
1297,4660,9,,,
1298,4669,9,,,
1299,4678,9,,,
1300,4688,10,,,
1301,4697,9,,,
1302,4706,9,,,
1303,4715,9,,,
1304,4724,9,,,
1305,4734,10,,,
1306,4743,9,,,
1307,4752,9,,,
1308,4761,9,,,
1309,4770,9,,,
1310,4780,10,,,
1311,4789,9,,,
1312,4798,9,,,
1313,4808,10,,,
1314,4817,9,,,
1315,4826,9,,,
1316,4836,10,,,
1317,4845,9,,,
1318,4854,9,,,
1319,4863,9,,,
1320,4873,10,,,
1321,4882,9,,,
1322,4892,10,,,
1323,4901,9,,,
1324,4910,9,,,
1325,4920,10,,,
1326,4929,9,,,
1327,4939,10,,,
1328,4948,9,,,
1329,4957,9,,,
1330,4967,10,,,
1331,4977,10,,,
1332,4986,9,,,
1333,4996,10,,,
1334,5005,9,,,
1335,5015,10,,,
1336,5025,10,,,
1337,5034,9,,,
1338,5044,10,,,
1339,5053,9,,,
1340,5063,10,,,
1341,5073,10,,,
1342,5083,10,,,
1343,5092,9,,,
1344,5102,10,,,
1345,5112,10,,,
1346,5121,9,,,
1347,5131,10,,,
1348,5141,10,,,
1349,5150,9,,,
1350,5160,10,,,
1351,5170,10,,,
1352,5180,10,,,
1353,5190,10,,,
1354,5199,9,,,
1355,5209,10,,,
1356,5219,10,,,
1357,5229,10,,,
1358,5239,10,,,
1359,5248,9,,,
1360,5258,10,,,
1361,5268,10,,,
1362,5278,10,,,
1363,5288,10,,,
1364,5298,10,,,
1365,5308,10,,,
1366,5318,10,,,
1367,5328,10,,,
1368,5338,10,,,
1369,5348,10,,,
1370,5359,11,,,
1371,5369,10,,,
1372,5379,10,,,
1373,5389,10,,,
1374,5399,10,,,
1375,5409,10,,,
1376,5419,10,,,
1377,5429,10,,,
1378,5439,10,,,
1379,5449,10,,,
1380,5460,11,,,
1381,5470,10,,,
1382,5480,10,,,
1383,5490,10,,,
1384,5500,10,,,
1385,5511,11,,,
1386,5521,10,,,
1387,5531,10,,,
1388,5541,10,,,
1389,5551,10,,,
1390,5562,11,,,
1391,5572,10,,,
1392,5582,10,,,
1393,5593,11,,,
1394,5603,10,,,
1395,5613,10,,,
1396,5624,11,,,
1397,5634,10,,,
1398,5644,10,,,
1399,5654,10,,,
1400,5665,11,,,
1401,5675,10,,,
1402,5686,11,,,
1403,5696,10,,,
1404,5707,11,,,
1405,5717,10,,,
1406,5728,11,,,
1407,5738,10,,,
1408,5749,11,,,
1409,5759,10,,,
1410,5770,11,,,
1411,5781,11,,,
1412,5791,10,,,
1413,5802,11,,,
1414,5812,10,,,
1415,5823,11,,,
1416,5834,11,,,
1417,5844,10,,,
1418,5855,11,,,
1419,5865,10,,,
1420,5876,11,,,
1421,5887,11,,,
1422,5898,11,,,
1423,5908,10,,,
1424,5919,11,,,
1425,5930,11,,,
1426,5940,10,,,
1427,5951,11,,,
1428,5962,11,,,
1429,5972,10,,,
1430,5983,11,,,
1431,5994,11,,,
1432,6005,11,,,
1433,6016,11,,,
1434,6027,11,,,
1435,6038,11,,,
1436,6049,11,,,
1437,6060,11,,,
1438,6071,11,,,
1439,6081,10,,,
1440,6092,11,,,
1441,6103,11,,,
1442,6114,11,,,
1443,6125,11,,,
1444,6136,11,,,
1445,6147,11,,,
1446,6158,11,,,
1447,6169,11,,,
1448,6180,11,,,
1449,6191,11,,,
1450,6203,12,,,
1451,6214,11,,,
1452,6225,11,,,
1453,6236,11,,,
1454,6247,11,,,
1455,6258,11,,,
1456,6269,11,,,
1457,6280,11,,,
1458,6291,11,,,
1459,6302,11,,,
1460,6314,12,,,
1461,6325,11,,,
1462,6336,11,,,
1463,6348,12,,,
1464,6359,11,,,
1465,6370,11,,,
1466,6382,12,,,
1467,6393,11,,,
1468,6404,11,,,
1469,6415,11,,,
1470,6427,12,,,
1471,6438,11,,,
1472,6450,12,,,
1473,6461,11,,,
1474,6472,11,,,
1475,6484,12,,,
1476,6495,11,,,
1477,6507,12,,,
1478,6518,11,,,
1479,6529,11,,,
1480,6541,12,,,
1481,6552,11,,,
1482,6564,12,,,
1483,6575,11,,,
1484,6587,12,,,
1485,6598,11,,,
1486,6610,12,,,
1487,6621,11,,,
1488,6633,12,,,
1489,6644,11,,,
1490,6656,12,,,
1491,6668,12,,,
1492,6680,12,,,
1493,6691,11,,,
1494,6703,12,,,
1495,6715,12,,,
1496,6726,11,,,
1497,6738,12,,,
1498,6750,12,,,
1499,6761,11,,,
1500,6773,12,,,
1501,6785,12,,,
1502,6797,12,,,
1503,6809,12,,,
1504,6820,11,,,
1505,6832,12,,,
1506,6844,12,,,
1507,6856,12,,,
1508,6868,12,,,
1509,6879,11,,,
1510,6891,12,,,
1511,6903,12,,,
1512,6915,12,,,
1513,6927,12,,,
1514,6939,12,,,
1515,6951,12,,,
1516,6963,12,,,
1517,6975,12,,,
1518,6987,12,,,
1519,6998,11,,,
1520,7011,13,,,
1521,7023,12,,,
1522,7035,12,,,
1523,7047,12,,,
1524,7059,12,,,
1525,7071,12,,,
1526,7083,12,,,
1527,7095,12,,,
1528,7107,12,,,
1529,7119,12,,,
1530,7132,13,,,
1531,7144,12,,,
1532,7156,12,,,
1533,7168,12,,,
1534,7180,12,,,
1535,7193,13,,,
1536,7205,12,,,
1537,7217,12,,,
1538,7229,12,,,
1539,7241,12,,,
1540,7254,13,,,
1541,7266,12,,,
1542,7278,12,,,
1543,7291,13,,,
1544,7303,12,,,
1545,7315,12,,,
1546,7328,13,,,
1547,7340,12,,,
1548,7352,12,,,
1549,7364,12,,,
1550,7377,13,,,
1551,7389,12,,,
1552,7402,13,,,
1553,7414,12,,,
1554,7426,12,,,
1555,7439,13,,,
1556,7451,12,,,
1557,7464,13,,,
1558,7476,12,,,
1559,7488,12,,,
1560,7501,13,,,
1561,7514,13,,,
1562,7526,12,,,
1563,7539,13,,,
1564,7551,12,,,
1565,7564,13,,,
1566,7577,13,,,
1567,7589,12,,,
1568,7602,13,,,
1569,7614,12,,,
1570,7627,13,,,
1571,7640,13,,,
1572,7653,13,,,
1573,7665,12,,,
1574,7678,13,,,
1575,7691,13,,,
1576,7703,12,,,
1577,7716,13,,,
1578,7729,13,,,
1579,7741,12,,,
1580,7754,13,,,
1581,7767,13,,,
1582,7780,13,,,
1583,7793,13,,,
1584,7805,12,,,
1585,7818,13,,,
1586,7831,13,,,
1587,7844,13,,,
1588,7857,13,,,
1589,7869,12,,,
1590,7882,13,,,
1591,7895,13,,,
1592,7908,13,,,
1593,7921,13,,,
1594,7934,13,,,
1595,7947,13,,,
1596,7960,13,,,
1597,7973,13,,,
1598,7986,13,,,
1599,7999,13,,,
1600,8013,14,,,
1601,8026,13,,,
1602,8039,13,,,
1603,8052,13,,,
1604,8065,13,,,
1605,8078,13,,,
1606,8091,13,,,
1607,8104,13,,,
1608,8117,13,,,
1609,8130,13,,,
1610,8144,14,,,
1611,8157,13,,,
1612,8170,13,,,
1613,8183,13,,,
1614,8196,13,,,
1615,8210,14,,,
1616,8223,13,,,
1617,8236,13,,,
1618,8249,13,,,
1619,8262,13,,,
1620,8276,14,,,
1621,8289,13,,,
1622,8303,14,,,
1623,8316,13,,,
1624,8329,13,,,
1625,8343,14,,,
1626,8356,13,,,
1627,8370,14,,,
1628,8383,13,,,
1629,8396,13,,,
1630,8410,14,,,
1631,8423,13,,,
1632,8437,14,,,
1633,8450,13,,,
1634,8464,14,,,
1635,8477,13,,,
1636,8491,14,,,
1637,8504,13,,,
1638,8518,14,,,
1639,8531,13,,,
1640,8545,14,,,
1641,8559,14,,,
1642,8572,13,,,
1643,8586,14,,,
1644,8599,13,,,
1645,8613,14,,,
1646,8627,14,,,
1647,8640,13,,,
1648,8654,14,,,
1649,8667,13,,,
1650,8681,14,,,
1651,8695,14,,,
1652,8709,14,,,
1653,8723,14,,,
1654,8736,13,,,
1655,8750,14,,,
1656,8764,14,,,
1657,8778,14,,,
1658,8792,14,,,
1659,8805,13,,,
1660,8819,14,,,
1661,8833,14,,,
1662,8847,14,,,
1663,8861,14,,,
1664,8875,14,,,
1665,8889,14,,,
1666,8903,14,,,
1667,8917,14,,,
1668,8931,14,,,
1669,8944,13,,,
1670,8958,14,,,
1671,8972,14,,,
1672,8986,14,,,
1673,9000,14,,,
1674,9014,14,,,
1675,9028,14,,,
1676,9042,14,,,
1677,9056,14,,,
1678,9070,14,,,
1679,9084,14,,,
1680,9099,15,,,
1681,9113,14,,,
1682,9127,14,,,
1683,9141,14,,,
1684,9155,14,,,
1685,9169,14,,,
1686,9183,14,,,
1687,9197,14,,,
1688,9211,14,,,
1689,9225,14,,,
1690,9240,15,,,
1691,9254,14,,,
1692,9268,14,,,
1693,9283,15,,,
1694,9297,14,,,
1695,9311,14,,,
1696,9326,15,,,
1697,9340,14,,,
1698,9354,14,,,
1699,9368,14,,,
1700,9383,15,,,
1701,9397,14,,,
1702,9412,15,,,
1703,9426,14,,,
1704,9440,14,,,
1705,9455,15,,,
1706,9469,14,,,
1707,9484,15,,,
1708,9498,14,,,
1709,9512,14,,,
1710,9527,15,,,
1711,9541,14,,,
1712,9556,15,,,
1713,9570,14,,,
1714,9585,15,,,
1715,9599,14,,,
1716,9614,15,,,
1717,9628,14,,,
1718,9643,15,,,
1719,9657,14,,,
1720,9672,15,,,
1721,9687,15,,,
1722,9702,15,,,
1723,9716,14,,,
1724,9731,15,,,
1725,9746,15,,,
1726,9760,14,,,
1727,9775,15,,,
1728,9790,15,,,
1729,9804,14,,,
1730,9819,15,,,
1731,9834,15,,,
1732,9849,15,,,
1733,9864,15,,,
1734,9878,14,,,
1735,9893,15,,,
1736,9908,15,,,
1737,9923,15,,,
1738,9938,15,,,
1739,9952,14,,,
1740,9967,15,,,
1741,9982,15,,,
1742,9997,15,,,
1743,10012,15,,,
1744,10027,15,,,
1745,10042,15,,,
1746,10057,15,,,
1747,10072,15,,,
1748,10087,15,,,
1749,10101,14,,,
1750,10117,16,,,
1751,10132,15,,,
1752,10147,15,,,
1753,10162,15,,,
1754,10177,15,,,
1755,10192,15,,,
1756,10207,15,,,
1757,10222,15,,,
1758,10237,15,,,
1759,10252,15,,,
1760,10268,16,,,
1761,10283,15,,,
1762,10298,15,,,
1763,10313,15,,,
1764,10328,15,,,
1765,10344,16,,,
1766,10359,15,,,
1767,10374,15,,,
1768,10389,15,,,
1769,10404,15,,,
1770,10420,16,,,
1771,10435,15,,,
1772,10450,15,,,
1773,10466,16,,,
1774,10481,15,,,
1775,10496,15,,,
1776,10512,16,,,
1777,10527,15,,,
1778,10542,15,,,
1779,10557,15,,,
1780,10573,16,,,
1781,10588,15,,,
1782,10604,16,,,
1783,10619,15,,,
1784,10635,16,,,
1785,10650,15,,,
1786,10666,16,,,
1787,10681,15,,,
1788,10697,16,,,
1789,10712,15,,,
1790,10728,16,,,
1791,10744,16,,,
1792,10759,15,,,
1793,10775,16,,,
1794,10790,15,,,
1795,10806,16,,,
1796,10822,16,,,
1797,10837,15,,,
1798,10853,16,,,
1799,10868,15,,,
1800,10884,16,,,
1801,10900,16,,,
1802,10916,16,,,
1803,10931,15,,,
1804,10947,16,,,
1805,10963,16,,,
1806,10978,15,,,
1807,10994,16,,,
1808,11010,16,,,
1809,11025,15,,,
1810,11041,16,,,
1811,11057,16,,,
1812,11073,16,,,
1813,11089,16,,,
1814,11105,16,,,
1815,11121,16,,,
1816,11137,16,,,
1817,11153,16,,,
1818,11169,16,,,
1819,11184,15,,,
1820,11200,16,,,
1821,11216,16,,,
1822,11232,16,,,
1823,11248,16,,,
1824,11264,16,,,
1825,11280,16,,,
1826,11296,16,,,
1827,11312,16,,,
1828,11328,16,,,
1829,11344,16,,,
1830,11361,17,,,
1831,11377,16,,,
1832,11393,16,,,
1833,11409,16,,,
1834,11425,16,,,
1835,11441,16,,,
1836,11457,16,,,
1837,11473,16,,,
1838,11489,16,,,
1839,11505,16,,,
1840,11522,17,,,
1841,11538,16,,,
1842,11554,16,,,
1843,11570,16,,,
1844,11586,16,,,
1845,11603,17,,,
1846,11619,16,,,
1847,11635,16,,,
1848,11651,16,,,
1849,11667,16,,,
1850,11684,17,,,
1851,11700,16,,,
1852,11717,17,,,
1853,11733,16,,,
1854,11749,16,,,
1855,11766,17,,,
1856,11782,16,,,
1857,11799,17,,,
1858,11815,16,,,
1859,11831,16,,,
1860,11848,17,,,
1861,11864,16,,,
1862,11881,17,,,
1863,11897,16,,,
1864,11914,17,,,
1865,11931,17,,,
1866,11947,16,,,
1867,11963,16,,,
1868,11980,17,,,
1869,11996,16,,,
1870,12013,17,,,
1871,12030,17,,,
1872,12046,16,,,
1873,12063,17,,,
1874,12079,16,,,
1875,12096,17,,,
1876,12113,17,,,
1877,12129,16,,,
1878,12146,17,,,
1879,12162,16,,,
1880,12179,17,,,
1881,12196,17,,,
1882,12213,17,,,
1883,12230,17,,,
1884,12246,16,,,
1885,12263,17,,,
1886,12280,17,,,
1887,12297,17,,,
1888,12314,17,,,
1889,12330,16,,,
1890,12347,17,,,
1891,12364,17,,,
1892,12381,17,,,
1893,12398,17,,,
1894,12415,17,,,
1895,12432,17,,,
1896,12449,17,,,
1897,12466,17,,,
1898,12483,17,,,
1899,12499,16,,,
1900,12516,17,,,
1901,12533,17,,,
1902,12550,17,,,
1903,12567,17,,,
1904,12584,17,,,
1905,12601,17,,,
1906,12618,17,,,
1907,12635,17,,,
1908,12652,17,,,
1909,12669,17,,,
1910,12687,18,,,
1911,12704,17,,,
1912,12721,17,,,
1913,12738,17,,,
1914,12755,17,,,
1915,12773,18,,,
1916,12790,17,,,
1917,12807,17,,,
1918,12824,17,,,
1919,12841,17,,,
1920,12859,18,,,
1921,12876,17,,,
1922,12893,17,,,
1923,12911,18,,,
1924,12928,17,,,
1925,12945,17,,,
1926,12963,18,,,
1927,12980,17,,,
1928,12997,17,,,
1929,13014,17,,,
1930,13032,18,,,
1931,13049,17,,,
1932,13067,18,,,
1933,13084,17,,,
1934,13101,17,,,
1935,13119,18,,,
1936,13136,17,,,
1937,13154,18,,,
1938,13171,17,,,
1939,13188,17,,,
1940,13206,18,,,
1941,13224,18,,,
1942,13241,17,,,
1943,13259,18,,,
1944,13276,17,,,
1945,13294,18,,,
1946,13312,18,,,
1947,13329,17,,,
1948,13347,18,,,
1949,13364,17,,,
1950,13382,18,,,
1951,13400,18,,,
1952,13418,18,,,
1953,13435,17,,,
1954,13453,18,,,
1955,13471,18,,,
1956,13488,17,,,
1957,13506,18,,,
1958,13524,18,,,
1959,13541,17,,,
1960,13559,18,,,
1961,13577,18,,,
1962,13595,18,,,
1963,13613,18,,,
1964,13630,17,,,
1965,13648,18,,,
1966,13666,18,,,
1967,13684,18,,,
1968,13702,18,,,
1969,13719,17,,,
1970,13737,18,,,
1971,13755,18,,,
1972,13773,18,,,
1973,13791,18,,,
1974,13809,18,,,
1975,13827,18,,,
1976,13845,18,,,
1977,13863,18,,,
1978,13881,18,,,
1979,13898,17,,,
1980,13917,19,,,
1981,13935,18,,,
1982,13953,18,,,
1983,13971,18,,,
1984,13989,18,,,
1985,14007,18,,,
1986,14025,18,,,
1987,14043,18,,,
1988,14061,18,,,
1989,14079,18,,,
1990,14098,19,,,
1991,14116,18,,,
1992,14134,18,,,
1993,14152,18,,,
1994,14170,18,,,
1995,14189,19,,,
1996,14207,18,,,
1997,14225,18,,,
1998,14243,18,,,
1999,14261,18,,,
2000,14280,19,,,
`; // â˜…â˜…â˜… CSVãƒ‡ãƒ¼ã‚¿è²¼ã‚Šä»˜ã‘çµ‚äº†ä½ç½® â˜…â˜…â˜…

        
        const STATUS_TO_RATING = {};
        const UNIQUE_LEVEL_TO_RATING = {};
        const STORAGE_KEY = 'umamusume_calc_input_data'; 
        const HISTORY_KEY = 'umamusume_calc_history_main'; // å±¥æ­´ã¯å˜ä¸€ã®ã‚­ãƒ¼ã§ç®¡ç†
        
        window.currentCalculation = null; 
        
        // å±¥æ­´ã‚½ãƒ¼ãƒˆç”¨å¤‰æ•°
        let currentSortKey = 'id'; 
        let currentSortDirection = 'desc'; 


        // ----------------------------------------------------
        // 2. CSVãƒ‘ãƒ¼ã‚¹ã¨è¨ˆç®—ãƒ­ã‚¸ãƒƒã‚¯
        // ----------------------------------------------------
        function parseCsvData(csvText) {
            if (!csvText || csvText.includes('// --- å®Ÿéš›ã® CSVãƒ‡ãƒ¼ã‚¿')) {
                console.error("CSVãƒ‡ãƒ¼ã‚¿ãŒè²¼ã‚Šä»˜ã‘ã‚‰ã‚Œã¦ã„ã¾ã›ã‚“ã€‚");
                return;
            }

            const lines = csvText.trim().split('\n').filter(line => !line.startsWith('//') && line.trim() !== '');
            
            for (let i = 1; i < lines.length; i++) {
                const line = lines[i].trim();
                if (!line) continue;

                const columns = line.split(',');
                
                const status = parseInt(columns[0]); 
                const rating = parseInt(columns[1]); 
                if (!isNaN(status) && !isNaN(rating)) {
                    STATUS_TO_RATING[status] = rating;
                }
                
                const uniqueLevel = parseInt(columns[4]); 
                const uniqueRating = parseInt(columns[5]); 
                if (!isNaN(uniqueLevel) && !isNaN(uniqueRating)) {
                    UNIQUE_LEVEL_TO_RATING[uniqueLevel] = uniqueRating;
                }
            }
        }

        function getStatusRating(statusValue) {
            // ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ãŒ0ã§ã‚‚è©•ä¾¡ç‚¹0ã‚’è¿”ã™ã‚ˆã†ã«ä¿®æ­£ (CSVã«0,0,0,,0,0ã‚’è¿½åŠ ã—ãŸãŸã‚ã€ãã®ã¾ã¾åˆ©ç”¨)
            statusValue = Math.min(Math.max(0, statusValue), 2000); 
            return STATUS_TO_RATING[statusValue] || 0; 
        }

        function getUniqueRating(level) {
            // å›ºæœ‰ãƒ¬ãƒ™ãƒ«ãŒ0ã§ã‚‚è©•ä¾¡ç‚¹0ã‚’è¿”ã™ã‚ˆã†ã«ä¿®æ­£ (CSVã«0,0,0,,0,0ã‚’è¿½åŠ ã—ãŸãŸã‚ã€ãã®ã¾ã¾åˆ©ç”¨)
            level = Math.min(Math.max(0, level), 6); 
            return UNIQUE_LEVEL_TO_RATING[level] || 0;
        }
        
        function getCurrentInputState() {
            // å…¥åŠ›æ¬„ãŒç©ºæ¬„ã®å ´åˆã¯ '0' ã§ã¯ãªãç©ºæ–‡å­—åˆ—ã‚’è¿”ã™ã‚ˆã†ã«ã—ã€
            // calculate()ã§ãƒ‘ãƒ¼ã‚¹æ™‚ã« '0' ã¨ã—ã¦å‡¦ç†ã™ã‚‹
            return {
                char_name: document.getElementById('char_name').value || '',
                calc_date: document.getElementById('calc_date').value || new Date().toISOString().slice(0, 10), 
                speed: document.getElementById('speed').value,
                stamina: document.getElementById('stamina').value,
                power: document.getElementById('power').value,
                guts: document.getElementById('guts').value,
                wisdom: document.getElementById('wisdom').value,
                unique_level: document.getElementById('unique_level').value,
                target_rating: document.getElementById('target_rating').value,
                sp: document.getElementById('sp').value,
                kirereality: document.getElementById('kirereality').checked,
                hari: document.getElementById('hari').checked
            };
        }

        function calculate() {
            // â˜…â˜…â˜… ä¿®æ­£ç®‡æ‰€: è¨ˆç®—æ™‚ã¯ç©ºæ¬„ã‚’ '0' ã¨ã—ã¦æ‰±ã†ãŒã€å…¥åŠ›æ¬„ã®è¡¨ç¤ºã¯å¤‰æ›´ã—ãªã„ â˜…â˜…â˜…
            const state = getCurrentInputState();
            
            // å…¥åŠ›æ¬„ã®å€¤ãŒç©ºæ¬„ã®å ´åˆã¯ 0 ã¨ã—ã¦æ‰±ã†ã€‚ãã†ã§ãªã„å ´åˆã¯ãƒ‘ãƒ¼ã‚¹ã™ã‚‹
            const speed = parseInt(state.speed) || 0;
            const stamina = parseInt(state.stamina) || 0;
            const power = parseInt(state.power) || 0;
            const guts = parseInt(state.guts) || 0;
            const wisdom = parseInt(state.wisdom) || 0;
            const unique_level = parseInt(state.unique_level) || 0;
            const target_rating = parseInt(state.target_rating) || 0;
            const sp_original = parseInt(state.sp) || 0;
            
            // -----------------------------------------------------------------------

            let sp_corrected = state.kirereality ? Math.ceil(sp_original / 0.9) : sp_original;
            const hariCorrection = state.hari ? 434 : 0;

            const statusPoints = getStatusRating(speed) + getStatusRating(stamina) + getStatusRating(power) + getStatusRating(guts) + getStatusRating(wisdom);
            const uniquePoints = getUniqueRating(unique_level);
            let skillPoints = Math.max(0, target_rating - statusPoints - uniquePoints - hariCorrection);
            const efficiency = sp_corrected > 0 ? (skillPoints / sp_corrected).toFixed(4) : "0.0000";
            const totalRating = statusPoints + uniquePoints + skillPoints + hariCorrection;

            window.currentCalculation = {
                // ä¿å­˜æ™‚ã«ã¯ã€å…¥åŠ›æ¬„ã®å€¤ï¼ˆç©ºæ¬„ã®å¯èƒ½æ€§ã‚ã‚Šï¼‰ã‚’ãã®ã¾ã¾ä¿å­˜ã™ã‚‹
                ...state, 
                sp_original: sp_original, // è¨ˆç®—ç”¨ã®0ã‚’å«ã‚€å€¤
                sp_corrected: sp_corrected, 
                statusPoints: statusPoints,
                uniquePoints: uniquePoints,
                skillPoints: skillPoints,
                efficiency: efficiency,
                totalRating: totalRating,
            };

            document.getElementById('status_points').textContent = statusPoints.toLocaleString();
            document.getElementById('unique_points').textContent = uniquePoints.toLocaleString();
            document.getElementById('skill_points').textContent = skillPoints.toLocaleString();
            document.getElementById('efficiency').textContent = efficiency;
            document.getElementById('total_rating').textContent = totalRating.toLocaleString();

            saveData();
        }

        // ----------------------------------------------------
        // 3. å±¥æ­´ã®ç®¡ç†ãƒ»ã‚½ãƒ¼ãƒˆãƒ»CRUD
        // ----------------------------------------------------

        function loadHistory() {
            const historyString = localStorage.getItem(HISTORY_KEY);
            return historyString ? JSON.parse(historyString) : [];
        }

        function saveHistory(history) {
            localStorage.setItem(HISTORY_KEY, JSON.stringify(history));
        }

        function clearInputs() {
            // 1. ã‚­ãƒ£ãƒ©ã‚¯ã‚¿åã‚’ä¿æŒ
            const charName = document.getElementById('char_name').value;
            
            // 2. ãã®ä»–ã®ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã‚’ç©ºæ¬„/ãƒªã‚»ãƒƒãƒˆ
            document.getElementById('speed').value = '';
            document.getElementById('stamina').value = '';
            document.getElementById('power').value = '';
            document.getElementById('guts').value = '';
            document.getElementById('wisdom').value = '';
            document.getElementById('unique_level').value = '';
            document.getElementById('target_rating').value = '';
            document.getElementById('sp').value = '';
            document.getElementById('kirereality').checked = false;
            document.getElementById('hari').checked = false;
            
            // æ—¥ä»˜ã‚’ä»Šæ—¥ã«æˆ»ã™
            document.getElementById('calc_date').value = new Date().toISOString().slice(0, 10); 

            // 3. ã‚­ãƒ£ãƒ©ã‚¯ã‚¿åã‚’å†è¨­å®š
            document.getElementById('char_name').value = charName;

            // 4. è‡ªå‹•ä¿å­˜ãƒ‡ãƒ¼ã‚¿ã¨è¡¨ç¤ºã‚’æ›´æ–°
            saveData(); 
            calculate(); 
        }

        function saveCurrentCalculationToWeb() {
            if (!window.currentCalculation) {
                alert("è¨ˆç®—çµæœãŒã‚ã‚Šã¾ã›ã‚“ã€‚ã¾ãšå€¤ã‚’å…¥åŠ›ã—ã¦è¨ˆç®—ã—ã¦ãã ã•ã„ã€‚");
                return;
            }

            // ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ãŒå…¨ã¦0ã®å ´åˆã€ä¿å­˜ã‚’ç¢ºèª
            // å…¥åŠ›æ¬„ãŒç©ºæ¬„ã®å ´åˆã‚‚ 0 ã¨ã—ã¦æ‰±ã†
            const getVal = (id) => parseInt(document.getElementById(id).value) || 0;

            const statusSum = getVal('speed') + getVal('stamina') + getVal('power') + getVal('guts') + getVal('wisdom');
            
            if (statusSum === 0 && !confirm("ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ãŒå…¨ã¦0ã§ã™ãŒã€ã“ã®è¨ˆç®—çµæœã‚’å±¥æ­´ã«ä¿å­˜ã—ã¾ã™ã‹ï¼Ÿ")) {
                return;
            }


            const history = loadHistory();
            
            // å±¥æ­´ã«ä¿å­˜ã™ã‚‹æ—¥ä»˜ã¯å…¥åŠ›æ¬„ã‹ã‚‰å–å¾— (YYYY-MM-DDå½¢å¼)
            const dateToSave = document.getElementById('calc_date').value;

            const dataToSave = {
                // å…¥åŠ›æ¬„ã®å€¤ã‚’ãã®ã¾ã¾ä¿å­˜
                char_name: window.currentCalculation.char_name,
                calc_date: dateToSave, 
                speed: window.currentCalculation.speed,
                stamina: window.currentCalculation.stamina,
                power: window.currentCalculation.power,
                guts: window.currentCalculation.guts,
                wisdom: window.currentCalculation.wisdom,
                unique_level: window.currentCalculation.unique_level,
                target_rating: window.currentCalculation.target_rating,
                // SPã¯ä¿å­˜æ™‚ã«å…¥åŠ›æ¬„ã®å€¤(ç©ºæ¬„ã®å¯èƒ½æ€§ã‚ã‚Š)ã‚’ä½¿ã†ãŒã€åŠ¹ç‡è¨ˆç®—ã«ã¯sp_original(0ã‚’å«ã‚€)ã‚’ä½¿ã†
                sp_original: window.currentCalculation.sp_original, 
                kirereality: window.currentCalculation.kirereality,
                hari: window.currentCalculation.hari,
                // è¨ˆç®—çµæœ
                id: Date.now(), 
                date: dateToSave,
                totalRating: window.currentCalculation.totalRating,
                efficiency: window.currentCalculation.efficiency
            };

            history.unshift(dataToSave); 
            if (history.length > 50) {
                history.pop(); 
            }

            saveHistory(history);
            displayHistory(history);
            alert(`ã€Œ${dataToSave.char_name || "ç„¡åã®ã‚¦ãƒå¨˜"}ã€ã®è¨ˆç®—çµæœã‚’å±¥æ­´ã«ä¿å­˜ã—ã¾ã—ãŸã€‚`);
            
            // â˜…â˜…â˜… ä¿å­˜å¾Œã«è‡ªå‹•ã‚¯ãƒªã‚¢ (ã‚­ãƒ£ãƒ©åä»¥å¤–) â˜…â˜…â˜…
            clearInputs();
        }

        function loadHistoryItem(id) {
            const history = loadHistory();
            const item = history.find(data => data.id === id);

            if (item) {
                // ãƒ­ãƒ¼ãƒ‰æ™‚ã«ã¯ä¿å­˜ã•ã‚ŒãŸå€¤(ç©ºæ¬„ã®å¯èƒ½æ€§ã‚ã‚Š)ã‚’ãã®ã¾ã¾å…¥åŠ›æ¬„ã«æˆ»ã™
                document.getElementById('char_name').value = item.char_name || '';
                document.getElementById('calc_date').value = item.date || new Date().toISOString().slice(0, 10);
                document.getElementById('speed').value = item.speed || '';
                document.getElementById('stamina').value = item.stamina || '';
                document.getElementById('power').value = item.power || '';
                document.getElementById('guts').value = item.guts || '';
                document.getElementById('wisdom').value = item.wisdom || '';
                document.getElementById('unique_level').value = item.unique_level || '';
                document.getElementById('target_rating').value = item.target_rating || '';
                document.getElementById('sp').value = item.sp_original ? item.sp_original.toString() : ''; // sp_originalã‹ã‚‰å€¤ã‚’å¾©å…ƒ
                document.getElementById('kirereality').checked = item.kirereality;
                document.getElementById('hari').checked = item.hari;
                
                saveData(); 
                calculate(); 
                
                alert(`ã€Œ${item.char_name || 'ç„¡å'}ã€ã®ãƒ‡ãƒ¼ã‚¿ã‚’å…¥åŠ›æ¬„ã«èª­ã¿è¾¼ã¿ã¾ã—ãŸã€‚`);
            }
        }

        function deleteHistoryItem(id) {
            if (!confirm("ã“ã®å±¥æ­´é …ç›®ã‚’å‰Šé™¤ã—ã¦ã‚‚ã‚ˆã‚ã—ã„ã§ã™ã‹ï¼Ÿ")) {
                return;
            }

            let history = loadHistory();
            const initialLength = history.length;
            
            history = history.filter(item => item.id !== id);
            
            if (history.length < initialLength) {
                saveHistory(history);
                displayHistory(history);
                alert("å±¥æ­´é …ç›®ã‚’å‰Šé™¤ã—ã¾ã—ãŸã€‚");
            }
        }

        function deleteAllHistory() {
            if (confirm("æœ¬å½“ã«ä¿å­˜ã•ã‚Œã¦ã„ã‚‹å…¨ã¦ã®å±¥æ­´ã‚’å‰Šé™¤ã—ã¾ã™ã‹ï¼Ÿã“ã®æ“ä½œã¯å…ƒã«æˆ»ã›ã¾ã›ã‚“ã€‚")) {
                localStorage.removeItem(HISTORY_KEY);
                displayHistory([]);
                alert("å±¥æ­´ã‚’å…¨ã¦å‰Šé™¤ã—ã¾ã—ãŸã€‚");
            }
        }
        
        function sortHistory(key) {
            let historyData = loadHistory();

            if (key === currentSortKey) {
                currentSortDirection = currentSortDirection === 'asc' ? 'desc' : 'asc';
            } else {
                currentSortKey = key;
                currentSortDirection = 'desc'; 
            }

            historyData.sort((a, b) => {
                let valA, valB;
                if (key === 'date') {
                    valA = a.date;
                    valB = b.date;
                } else if (key === 'totalRating') {
                    valA = a.totalRating;
                    valB = b.totalRating;
                } else {
                    return 0;
                }

                if (valA < valB) {
                    return currentSortDirection === 'asc' ? -1 : 1;
                }
                if (valA > valB) {
                    return currentSortDirection === 'asc' ? 1 : -1;
                }
                return 0;
            });

            displayHistory(historyData);
        }

        function displayHistory(historyData = loadHistory()) {
            const container = document.getElementById('history_table_container');
            const section = document.getElementById('history_section');
            
            if (historyData.length === 0) {
                container.innerHTML = '<p style="text-align: center; color: #666;">ä¿å­˜ã•ã‚ŒãŸå±¥æ­´ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚</p>';
                section.style.display = 'none';
                return;
            }
            
            section.style.display = 'block';

            const getSortIndicator = (key) => {
                if (key !== currentSortKey) return '';
                return currentSortDirection === 'asc' ? 'â–²' : 'â–¼';
            };

            let tableHTML = `
                <table class="history-table">
                    <thead>
                        <tr>
                            <th class="sortable" onclick="sortHistory('date')">æ—¥ä»˜ <span class="sort-indicator">${getSortIndicator('date')}</span></th>
                            <th>ã‚­ãƒ£ãƒ©å</th>
                            <th>è©•ä¾¡ç‚¹</th> 
                            <th class="sortable" onclick="sortHistory('totalRating')">åˆè¨ˆè©•ä¾¡ç‚¹ <span class="sort-indicator">${getSortIndicator('totalRating')}</span></th>
                            <th>åŠ¹ç‡</th>
                            <th>èª­è¾¼</th>
                            <th>å‰Šé™¤</th>
                        </tr>
                    </thead>
                    <tbody>
            `;

            historyData.forEach(data => {
                tableHTML += `
                    <tr>
                        <td>${data.date}</td>
                        <td>${data.char_name || 'ç„¡å'}</td>
                        <td>${(parseInt(data.target_rating) || 0).toLocaleString()}</td>
                        <td>${data.totalRating.toLocaleString()}</td>
                        <td>${data.efficiency}</td>
                        <td class="load-btn" onclick="loadHistoryItem(${data.id})">ğŸ”—</td>
                        <td class="delete-btn" onclick="deleteHistoryItem(${data.id})">âŒ</td>
                    </tr>
                `;
            });

            tableHTML += `
                    </tbody>
                </table>
            `;
            
            container.innerHTML = tableHTML;
        }

        // ----------------------------------------------------
        // 4. ãƒ‡ãƒ¼ã‚¿ç§»è¡Œ (Base64 ID)
        // ----------------------------------------------------

        /**
         * å±¥æ­´å…¨ä½“ã‚’Base64ã§ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‰ã—ã€URLã¨ã—ã¦ã‚³ãƒ”ãƒ¼ã™ã‚‹
         */
        function generateShareIdForAllHistory() {
            const history = loadHistory();
            if (history.length === 0) {
                alert("ä¿å­˜ã•ã‚ŒãŸå±¥æ­´ãŒã‚ã‚Šã¾ã›ã‚“ã€‚ã¾ãšå±¥æ­´ã«ãƒ‡ãƒ¼ã‚¿ã‚’ä¿å­˜ã—ã¦ãã ã•ã„ã€‚");
                return;
            }

            const historyJson = JSON.stringify(history);
            const base64Id = btoa(historyJson);
            
            const shareUrl = window.location.href.split('#')[0] + "#" + base64Id;

            if (navigator.clipboard && navigator.clipboard.writeText) {
                navigator.clipboard.writeText(shareUrl).then(() => {
                    alert(`å±¥æ­´å…¨ä½“ï¼ˆ${history.length}ä»¶ï¼‰ã®ãƒ‡ãƒ¼ã‚¿ç§»è¡Œç”¨IDã‚’ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã«ã‚³ãƒ”ãƒ¼ã—ã¾ã—ãŸï¼\nï¼ˆåˆ¥ç«¯æœ«ã§URLå…¨ä½“ã¾ãŸã¯IDã‚’èª­ã¿è¾¼ã¿æ¬„ã«è²¼ã‚Šä»˜ã‘ã¦å¾©å…ƒã—ã¦ãã ã•ã„ï¼‰`);
                }).catch(err => {
                    console.error('ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã¸ã®ã‚³ãƒ”ãƒ¼ã«å¤±æ•—:', err);
                    alert(`ãƒ‡ãƒ¼ã‚¿ç§»è¡Œç”¨IDï¼ˆæ‰‹å‹•ã‚³ãƒ”ãƒ¼ç”¨ï¼‰:\n${base64Id}\n\nï¼ˆæ‰‹å‹•ã§ã‚³ãƒ”ãƒ¼ã—ã¦ãã ã•ã„ï¼‰`);
                });
            } else {
                alert(`ãƒ‡ãƒ¼ã‚¿ç§»è¡Œç”¨IDï¼ˆæ‰‹å‹•ã‚³ãƒ”ãƒ¼ç”¨ï¼‰:\n${base64Id}\n\nï¼ˆæ‰‹å‹•ã§ã‚³ãƒ”ãƒ¼ã—ã¦ãã ã•ã„ï¼‰`);
            }
        }

        /**
         * ç§»è¡Œç”¨IDå…¥åŠ›æ¬„ã‹ã‚‰æ‰‹å‹•ã§IDã‚’èª­ã¿è¾¼ã‚€
         */
        function loadManualMigrationId() {
            const input = document.getElementById('migration_id_input').value.trim();
            if (!input) {
                alert("IDã¾ãŸã¯URLã‚’å…¥åŠ›ã—ã¦ãã ã•ã„ã€‚");
                return;
            }
            
            let shareId = input;
            
            if (input.includes('#')) {
                shareId = input.split('#').pop();
            }
            
            if (shareId) {
                if (loadFromShareId(shareId)) {
                    document.getElementById('migration_id_input').value = '';
                }
            } else {
                alert("æœ‰åŠ¹ãªç§»è¡Œç”¨IDã‚’æŠ½å‡ºã§ãã¾ã›ã‚“ã§ã—ãŸã€‚");
            }
        }
        
        /**
         * Base64IDæ–‡å­—åˆ—ã‚’è§£æã—ã€å˜ä¸€ãƒ‡ãƒ¼ã‚¿ã¾ãŸã¯å±¥æ­´å…¨ä½“ã‚’å¾©å…ƒã™ã‚‹
         */
        function loadFromShareId(base64Id) {
            try {
                const decodedString = atob(base64Id);
                
                // 1. å±¥æ­´å…¨ä½“ãƒ‡ãƒ¼ã‚¿ï¼ˆJSONé…åˆ—ï¼‰ã®è©¦è¡Œ
                if (decodedString.startsWith('[')) {
                    const historyArray = JSON.parse(decodedString);
                    if (Array.isArray(historyArray) && historyArray.every(item => item.id && item.date && item.totalRating)) {
                        
                        if (confirm(`å±¥æ­´å…¨ä½“ï¼ˆ${historyArray.length}ä»¶ï¼‰ã‚’èª­ã¿è¾¼ã¿ã¾ã™ã€‚ç¾åœ¨ã®å±¥æ­´ã¯ä¸Šæ›¸ãã•ã‚Œã¾ã™ãŒã‚ˆã‚ã—ã„ã§ã™ã‹ï¼Ÿ`)) {
                            saveHistory(historyArray);
                            displayHistory(historyArray);
                            alert(`ãƒ‡ãƒ¼ã‚¿ç§»è¡Œç”¨IDã‹ã‚‰å±¥æ­´å…¨ä½“ã‚’èª­ã¿è¾¼ã¿ã€ä¿å­˜ã—ã¾ã—ãŸã€‚`);
                            return true;
                        } else {
                            return false;
                        }
                    }
                }
                
                // 2. å˜ä¸€ãƒ‡ãƒ¼ã‚¿ï¼ˆæ—§å½¢å¼ã®å…±æœ‰IDï¼‰ã®è©¦è¡Œ
                const values = decodedString.split('|').map(v => decodeURIComponent(v));
                
                if (values.length === 11) { // æ—§å½¢å¼ã®å˜ä¸€ãƒ‡ãƒ¼ã‚¿ã«ã¯æ—¥ä»˜ãŒå«ã¾ã‚Œãªã„ãŸã‚ã€äº’æ›æ€§ç¶­æŒ
                    const [
                        char_name, speed, stamina, power, guts, wisdom, 
                        unique_level, target_rating, sp, isKirereality, isHari
                    ] = values;

                    document.getElementById('char_name').value = char_name;
                    document.getElementById('calc_date').value = new Date().toISOString().slice(0, 10); // æ—¥ä»˜ã¯ä»Šæ—¥ã«ãƒªã‚»ãƒƒãƒˆ
                    document.getElementById('speed').value = speed;
                    document.getElementById('stamina').value = stamina;
                    document.getElementById('power').value = power;
                    document.getElementById('guts').value = guts;
                    document.getElementById('wisdom').value = wisdom;
                    document.getElementById('unique_level').value = unique_level;
                    document.getElementById('target_rating').value = target_rating;
                    document.getElementById('sp').value = sp;
                    document.getElementById('kirereality').checked = (isKirereality === '1');
                    document.getElementById('hari').checked = (isHari === '1');
                    
                    saveData();
                    calculate();
                    alert("ãƒ‡ãƒ¼ã‚¿ç§»è¡Œç”¨IDã‹ã‚‰å˜ä¸€ã®è¨ˆç®—ãƒ‡ãƒ¼ã‚¿ã‚’å…¥åŠ›æ¬„ã«èª­ã¿è¾¼ã¿ã¾ã—ãŸã€‚");
                    return true;
                }

                throw new Error("ä¸æ˜ãªãƒ‡ãƒ¼ã‚¿å½¢å¼ã§ã™ã€‚");
            } catch (e) {
                console.error("å…±æœ‰IDã®èª­ã¿è¾¼ã¿ã«å¤±æ•—ã—ã¾ã—ãŸ:", e);
                alert("å…±æœ‰IDãŒä¸æ­£ã€ã¾ãŸã¯ç ´æã—ã¦ã„ã¾ã™ã€‚");
                return false;
            }
        }


        // ----------------------------------------------------
        // 5. å…¥åŠ›å€¤ã®è‡ªå‹•ä¿å­˜ãƒ»å¾©å…ƒæ©Ÿèƒ½
        // ----------------------------------------------------

        function saveData() {
            const data = getCurrentInputState();
            
            // å…¨ã¦ã®å…¥åŠ›ãŒç©ºæ¬„ã§ã‚ã‚‹ã‹ãƒã‚§ãƒƒã‚¯
            const isAllEmpty = 
                data.speed === '' && 
                data.stamina === '' &&
                data.power === '' &&
                data.guts === '' &&
                data.wisdom === '' &&
                data.unique_level === '' &&
                data.target_rating === '' &&
                data.sp === '' &&
                data.char_name === '' && // ã‚­ãƒ£ãƒ©åãŒç©ºã®å ´åˆã‚‚ã‚¯ãƒªã‚¢çŠ¶æ…‹ã¨è¦‹ãªã™
                data.kirereality === false &&
                data.hari === false;

            // ã™ã¹ã¦ç©ºæ¬„ã®å ´åˆã¯è‡ªå‹•ä¿å­˜ã‚’è¡Œã‚ãªã„
            if (!isAllEmpty) {
                localStorage.setItem(STORAGE_KEY, JSON.stringify(data));
            } else {
                localStorage.removeItem(STORAGE_KEY);
            }
        }

        function loadData() {
            const dataString = localStorage.getItem(STORAGE_KEY);
            const today = new Date().toISOString().slice(0, 10);
            
            if (dataString) {
                const data = JSON.parse(dataString);
                // ä¿å­˜ã•ã‚Œã¦ã„ã‚‹å€¤ã‚’ãã®ã¾ã¾è¨­å®š (ç©ºæ¬„ã®å ´åˆã¯ç©ºæ¬„)
                document.getElementById('char_name').value = data.char_name || '';
                document.getElementById('calc_date').value = data.calc_date || today; 
                document.getElementById('speed').value = data.speed || '';
                document.getElementById('stamina').value = data.stamina || '';
                document.getElementById('power').value = data.power || '';
                document.getElementById('guts').value = data.guts || '';
                document.getElementById('wisdom').value = data.wisdom || '';
                document.getElementById('unique_level').value = data.unique_level || '';
                document.getElementById('target_rating').value = data.target_rating || '';
                document.getElementById('sp').value = data.sp || '';
                document.getElementById('kirereality').checked = data.kirereality || false;
                document.getElementById('hari').checked = data.hari || false;
            } else {
                // åˆå›ãƒ­ãƒ¼ãƒ‰æ™‚ã‚„ãƒ‡ãƒ¼ã‚¿å‰Šé™¤å¾Œã¯ä»Šæ—¥ã®æ—¥ä»˜ã‚’è¨­å®šã—ã€ä»–ã¯ç©ºæ¬„ã®ã¾ã¾
                document.getElementById('calc_date').value = today;
            }
        }

        // ----------------------------------------------------
        // 6. ãƒšãƒ¼ã‚¸ãƒ­ãƒ¼ãƒ‰æ™‚ã®åˆæœŸåŒ–å‡¦ç†
        // ----------------------------------------------------

        window.onload = function() {
            parseCsvData(csvDataString);
            
            // 1. URLãƒãƒƒã‚·ãƒ¥ã‹ã‚‰ã®èª­ã¿è¾¼ã¿ã‚’æœ€å„ªå…ˆï¼ˆãƒ‡ãƒ¼ã‚¿ç§»è¡Œç”¨ï¼‰
            const hash = window.location.hash.substring(1); 
            if (hash) {
                loadFromShareId(hash);
            }
            
            // 2. å…¥åŠ›å€¤ã¨å±¥æ­´ã®èª­ã¿è¾¼ã¿
            loadData();
            // åˆæœŸçŠ¶æ…‹ã§ã¯ç©ºæ¬„ãªã®ã§ã€è¨ˆç®—çµæœã¯ã™ã¹ã¦0ã«ãªã‚‹
            calculate();
            displayHistory(); 
        };
    </script>
</body>
</html>
